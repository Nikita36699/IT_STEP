-- Відділення (Departments)
-- ■ Ідентифікатор (Id). Унікальний ідентифікатор відділення.
-- ▷ Тип даних — int.
-- ▷ Автоприріст.
-- ▷ Не містить null-значення.
-- ▷ Первинний ключ.
-- ■ Корпус (Building). Номер корпусу, в якому знаходиться
-- відділення.
-- ▷ Тип даних — int.
-- ▷ Не містить null-значення.
-- ▷ Має бути в діапазоні від 1 до 5.
-- ■ Фінансування (Financing). Фонд фінансування відділення.
-- ▷ Тип даних для зберігання грошових значень.
-- ▷ Не містить null-значення.
-- ▷ Не може бути менше, ніж 0.
-- ▷ Значення за замовчуванням — 0.
-- ■ Назва (Name). Назва відділення.
-- ▷ Тип даних — varchar(100).
-- ▷ Не містить null-значення.
-- ▷ Не може бути порожньою.
-- ▷ Має бути унікальною


CREATE TABLE DEPARTMENTS (
	DEPARTMENT_ID SERIAL NOT NULL PRIMARY KEY,
	BUILDING INT NOT NULL CHECK(BUILDING BETWEEN 1 AND 5),
	FINANCING INT  NOT NULL CHECK(FINANCING >= 0),
	DEPARTMENT_NAME VARCHAR(100) NOT NULL UNIQUE
);

INSERT INTO DEPARTMENTS (BUILDING, FINANCING, DEPARTMENT_NAME) VALUES
(1, 500000, 'Кардіологія'),
(2, 350000, 'Неврологія'),
(3, 200000, 'Хірургія'),
(4, 150000, 'Терапія'),
(1, 400000, 'Педіатрія'),
(5, 180000, 'Ортопедія'),
(2, 250000, 'Акушерство та гінекологія');

SELECT *
FROM DEPARTMENTS;
-- ¾ Захворювання (Diseases)
-- ■ Ідентифікатор (Id). Унікальний ідентифікатор
-- захво-рювання.
-- ▷ Тип даних — int.
-- ▷ Автоприріст.
-- ▷ Не містить null-значення.
-- ▷ Первинний ключ.
-- ■ Назва (Name). Назва захворювання.
-- ▷ Тип даних — varchar(100).
-- ▷ Не містить null-значення.
-- ▷ Не може бути порожньою.
-- ▷ Має бути унікальною.
-- ■ Ступінь тяжкості (Severity). Ступінь тяжкості захво-
-- рювання.
-- ▷ Тип даних — int.
-- ▷ Не містить null-значення.
-- Практичне завдання
-- 4
-- ▷ Не може бути менше, ніж 1.
-- ▷ Значення за замовчуванням — 1.
CREATE TABLE DISEASES(
	ID SERIAL NOT NULL PRIMARY KEY,
	NAME VARCHAR(100) NOT NULL CHECK(NAME != '') UNIQUE,
	SEVERITY INT NOT NULL CHECK(SEVERITY >= 1) DEFAULT 1
);


INSERT INTO DISEASES (NAME, SEVERITY) VALUES
('Грип', 2),
('Пневмонія', 4),
('Мігрень', 3),
('Діабет', 5),
('Гіпертонія', 3),
('Астма', 4),
('Бронхіт', 3),
('Отит', 2),
('Апендицит', 4),
('Анемія', 3);

-- INSERT INTO DISEASES(NAME, SEVERITY)
-- VALUES ('Инсульт', 4);

SELECT *
FROM DISEASES;


-- ¾ Лікарі (Doctors)
-- ■ Ідентифікатор (Id). Унікальний ідентифікатор
-- лікаря.
-- ▷ Тип даних — int.
-- ▷ Автоприріст.
-- ▷ Не містить null-значення.
-- ▷ Первинний ключ.
-- ■ Ім’я (Name). Ім’я лікаря.
-- ▷ Тип даних — varchar(255).
-- ▷ Не містить null-значення.
-- ▷ Не може бути порожнє.
-- ■ Телефон (Phone). Телефонний номер лікаря.
-- ▷ Тип даних — char(10).
-- ▷ Може містити null-значення.
-- ■ Ставка (Salary). Ставка лікаря.
-- ▷ Тип даних для зберігання грошових значень.
-- ▷ Не містить null-значення.
-- ▷ Не може бути меншою або дорівнювати 0.
-- ■ Прізвище (Surname). Прізвище лікаря.
-- ▷ Тип даних — varchar(255).
-- ▷ Не містить null-значення.
-- ▷ Не може бути порожнє
CREATE TABLE DOCTORS(
	ID SERIAL NOT NULL  PRIMARY KEY,
	NAME VARCHAR(255) NOT NULL CHECK(NAME != ''),
	PHONE CHAR(10),
	SALARY INT NOT NULL CHECK(SALARY > 0),
	SURNAME VARCHAR(255) NOT NULL CHECK(SURNAME != '')	
);



INSERT INTO DOCTORS (NAME, SURNAME, PHONE, SALARY) VALUES
('Олег', 'Петренко', '0671234567', 25000),
('Марина', 'Іванова', '0976543210', 27000),
('Ігор', 'Савченко', '0502345678', 31000),
('Олена', 'Коваленко', '0638765432', 29000),
('Сергій', 'Бондар', '0931239876', 26000),
('Наталія', 'Мельник', '0689988776', 24000),
('Василь', 'Шевченко', '0661122334', 33000),
('Інна', 'Ткаченко', '0954433221', 28000),
('Павло', 'Григоренко', '0739988123', 27000),
('Ірина', 'Данилюк', '0976655443', 30000),
('Михайло', 'Кравець', '0507766554', 26000),
('Світлана', 'Романюк', '0639988775', 29000),
('Андрій', 'Литвин', '0678899001', 25000),
('Катерина', 'Дорошенко', '0937788990', 31000),
('Володимир', 'Сидоренко', '0965544332', 27000),
('Тетяна', 'Мазур', '0503322119', 26000),
('Богдан', 'Кучер', '0736655778', 30000),
('Юлія', 'Поліщук', '0675544338', 24000),
('Олександр', 'Зінченко', '0689988774', 31000),
('Людмила', 'Остапчук', '0956677889', 27000),
('Руслан', 'Гордієнко', '0637788995', 28000),
('Ганна', 'Рибак', '0976677885', 29000),
('Дмитро', 'Ковалишин', '0508899776', 32000),
('Ілона', 'Павленко', '0933344557', 26000),
('Ростислав', 'Терещенко', '0667788992', 25000),
('Оксана', 'Луценко', '0978899007', 30000),
('Мирослава', 'Жук', '0501122335', 27000),
('Євген', 'Семенюк', '0683344556', 31000),
('Аліна', 'Марченко', '0958899778', 26000),
('Григорій', 'Панченко', '0635544331', 28000),
('Дарина', 'Мороз', '0678899112', 27000),
('Максим', 'Войтенко', '0506655443', 32000),
('Ольга', 'Кириленко', '0937766554', 29000),
('Артур', 'Дубровський', '0689988001', 24000),
('Роман', 'Герасимчук', '0661122445', 31000),
('Лариса', 'Білан', '0959988770', 25000),
('Іван', 'Тимощук', '0633344112', 28000),
('Софія', 'Кушнір', '0734455667', 29000),
('Юрій', 'Дяченко', '0976655332', 31000),
('Вероніка', 'Богач', '0507766889', 27000);

SELECT *
FROM DOCTORS;
-- ¾ Обстеження (Examinations)
-- ■ Ідентифікатор (Id). Унікальний ідентифікатор
-- обсте-ження.
-- Практичне завдання
-- 5
-- ▷ Тип даних — int.
-- ▷ Автоприріст.
-- ▷ Не містить null-значення.
-- ▷ Первинний ключ.
-- ■ День тижня (DayOfWeek). День тижня, коли прово-
-- диться обстеження.
-- ▷ Тип даних — int.
-- ▷ Не містить null-значення.
-- ▷ Має бути в діапазоні від 1 до 7.
-- ■ Час завершення (EndTime). Час завершення обстеження.
-- ▷ Тип даних для зберігання часу.
-- ▷ Не містить null-значення.
-- ▷ Має бути більше, ніж час початку обстеження.
-- ■ Назва (Name). Назва обстеження.
-- ▷ Тип даних — varchar(100).
-- ▷ Не містить null-значення.
-- ▷ Не може бути порожньою.
-- ▷ Має бути унікальною.
-- ■ Час початку (StartTime). Час початку обстеження.
-- ▷ Тип даних для зберігання часу.
-- ▷ Не містить null-значення.
-- ▷ Має бути в діапазоні від 8:00 до 18:00.
CREATE TABLE EXAMINATIONS(
	ID  SERIAL  NOT NULL PRIMARY KEY,
	DAYOFWEEK INT NOT NULL CHECK(DAYOFWEEK BETWEEN 1 AND 7),
	ENDTIME TIME NOT NULL CHECK(ENDTIME > STARTTIME),
	NAME VARCHAR(100) NOT NULL CHECK(NAME != '') UNIQUE,
	STARTTIME TIME NOT NULL CHECK(STARTTIME BETWEEN '08:00' AND '18:00')
);

INSERT INTO EXAMINATIONS (DAYOFWEEK, ENDTIME, NAME, STARTTIME) VALUES
(1, '09:00', 'Огляд терапевта', '08:00'),
(1, '10:30', 'Консультація кардіолога', '09:30'),
(1, '11:30', 'Огляд педіатра', '10:30'),
(2, '09:45', 'Прийом хірурга', '09:00'),
(2, '11:15', 'Консультація невропатолога', '10:30'),
(2, '12:30', 'Огляд ортопеда', '11:30'),
(3, '10:00', 'Огляд окуліста', '09:00'),
(3, '11:00', 'Консультація гастроентеролога', '10:00'),
(3, '12:15', 'Огляд дерматолога', '11:15'),
(4, '09:30', 'Консультація ендокринолога', '08:30'),
(4, '10:45', 'Огляд ЛОРа', '09:45'),
(4, '12:00', 'Огляд ревматолога', '11:00'),
(5, '09:50', 'Огляд стоматолога', '09:00'),
(5, '11:10', 'Консультація алерголога', '10:10'),
(5, '12:20', 'Прийом психотерапевта', '11:20'),
(6, '09:40', 'Огляд уролога', '09:00'),
(6, '10:55', 'Огляд гінеколога', '10:00'),
(6, '12:10', 'Консультація офтальмолога', '11:10'),
(7, '10:15', 'Огляд отоларинголога', '09:15'),
(7, '11:45', 'Огляд фтизіатра', '10:45');

SELECT *
FROM EXAMINATIONS;








-- ¾ Палати (Wards)
-- ■ Ідентифікатор (Id). Унікальний ідентифікатор.
-- ▷ Тип даних — int.
-- ▷ Автоприріст.
-- ▷ Не містить null-значення.
-- Практичне завдання
-- 6
-- ▷ Первинний ключ.
-- ■ Корпус (Building). Номер корпусу, де знаходиться
-- палата.
-- ▷ Тип даних — int.
-- ▷ Не містить null-значення.
-- ▷ Має бути в діапазоні від 1 до 5.
-- ■ Поверх (Floor). Номер поверху, на якому
-- знаходиться палата.
-- ▷ Тип даних — int.
-- ▷ Не містить null-значення.
-- ▷ Не може бути менше, ніж 1.
-- ■ Назва (Name). Назва палати.
-- ▷ Тип даних — varchar(20).
-- ▷ Не містить null-значення.
-- ▷ Не може бути порожньою.
-- ▷ Має бути унікальною.

CREATE TABLE WARDS (
	ID SERIAL NOT NULL PRIMARY KEY,
	DEPARTMENT_ID INT NOT NULL REFERENCES DEPARTMENTS(DEPARTMENT_ID),
	FLOOR INT NOT NULL CHECK(FLOOR >= 1),
	NAME VARCHAR(20) NOT NULL CHECK(NAME != '') UNIQUE
);


INSERT INTO WARDS (DEPARTMENT_ID, FLOOR, NAME) VALUES
	(1, 1, 'Палата №101'),
	(1, 2, 'Палата №102'),
	(1, 3, 'Палата №103'),
	(2, 1, 'Палата №201'),
	(2, 2, 'Палата №202'),
	(2, 3, 'Палата №203'),
	(3, 1, 'Палата №301'),
	(3, 2, 'Палата №302'),
	(3, 3, 'Палата №303'),
	(4, 1, 'Палата №401'),
	(4, 2, 'Палата №402'),
	(5, 1, 'Палата №501'),
	(5, 2, 'Палата №502'),
	(5, 3, 'Палата №503'),
	(6, 1, 'Палата №601'),
	(6, 2, 'Палата №602'),
	(7, 1, 'Палата №701'),
	(7, 2, 'Палата №702'),
	(7, 3, 'Палата №703');




-- Завдання 2
-- Для бази даних «Таблиця» створіть такі запити:
-- 1. Вивести вміст таблиці палат.
SELECT *
FROM WARDS;



-- 2. Вивести прізвища та телефони усіх лікарів.
SELECT SURNAME, PHONE
FROM DOCTORS;



-- 3. Вивести усі поверхи без повторень, де розміщуються
-- палати.
SELECT DISTINCT FLOOR
FROM WARDS;


-- 4. Вивести назви захворювань під назвою « N a me of Disease» та ступінь їхньої тяжкості під назвою «Severity of Disease».
SELECT NAME  AS "Name of Disease", SEVERITY AS "Severity of Disease"  
FROM DISEASES;


-- 5. Вивести назви відділень, які знаходяться у корпусі 5
-- з фондом фінансування меншим, ніж 30000.
SELECT *
FROM DEPARTMENTS;


SELECT DEPARTMENT_NAME, BUILDING
FROM DEPARTMENTS 
WHERE BUILDING = 5 AND  FINANCING < 300000;


-- 6. Вивести назви відділень, які знаходяться у корпусі 3 з
-- фондом фінансування у діапазоні від 12000 до 15000.
SELECT DEPARTMENT_NAME, BUILDING
FROM DEPARTMENTS 
WHERE BUILDING = 3 AND  FINANCING BETWEEN 120000 AND  1500000;








-- 9. Вивести назви, корпуси та фонди фінансування від-
-- ділень, які знаходяться у корпусах 3 або 1 та мають
-- фонд фінансування менший, ніж 11000 або більший
-- за 25000.
SELECT DEPARTMENT_NAME, BUILDING, FINANCING
FROM DEPARTMENTS 
WHERE (BUILDING = 3 OR BUILDING = 1) AND (FINANCING < 110000 OR FINANCING > 250000 );

SELECT *
FROM DEPARTMENTS;


-- 10. Вивести прізвища лікарів, зарплата с (ума ставки та
-- надбавки 1200) яких перевищує 15000.
SELECT *
FROM DOCTORS;

SELECT SURNAME, SALARY 
FROM DOCTORS 
WHERE SALARY + 1200 >= 15000;



-- 11. Вивести прізвища лікарів, у яких половина зарплати
-- перевищує триразову надбавку у вигляді 5000.
SELECT SURNAME, SALARY 
FROM DOCTORS 
WHERE SALARY / 2 >= 5000 * 3;



-- 12. Вивести назви обстежень без повторень, які прово-
-- дяться у перші три дні тижня з 10:00 до 13:00.
SELECT *
FROM EXAMINATIONS;

SELECT   NAME, DAYOFWEEK, STARTTIME, ENDTIME
FROM EXAMINATIONS
WHERE DAYOFWEEK BETWEEN 1 AND 3 AND STARTTIME >= '10:00' AND ENDTIME <= '13:00';


-- 13. Вивести назви та номери корпусів відділень, які зна-
-- ходяться у корпусах 1, 3, 8 або 10.
SELECT BUILDING, DEPARTMENT_NAME
FROM  DEPARTMENTS
WHERE BUILDING IN (1, 3, 8, 10) ;

-- 14. Вивести назви захворювань усіх ступенів тяжкості,
-- крім 1-го та 2-го.
SELECT *
FROM DISEASES;


SELECT NAME, SEVERITY
FROM DISEASES
WHERE SEVERITY NOT IN (1, 2);



-- 15. Вивести назви відділень, які не знаходяться у
-- першому або третьому корпусі.
SELECT BUILDING, DEPARTMENT_NAME
FROM  DEPARTMENTS
WHERE BUILDING  NOT IN (3, 1);

-- 16. Вивести назви відділень, які знаходяться у першому
-- або третьому корпусі.
SELECT BUILDING, DEPARTMENT_NAME
FROM  DEPARTMENTS
WHERE BUILDING   IN (3, 1);


-- 17. Вивести прізвища лікарів, що починаються з літери
-- «N».
SELECT *
FROM DOCTORS;

SELECT SURNAME
FROM DOCTORS
WHERE SURNAME ILIKE 'П%';

-- 8. Вивести назви палат, які знаходяться у корпусах 4 та
-- 5 на 1-му поверсі.
SELECT *
FROM DEPARTMENTS;

SELECT *
FROM WARDS;

SELECT COUNT(*)
FROM DEPARTMENTS;--7

SELECT COUNT(*)
FROM WARDS;--19

SELECT *
FROM DEPARTMENTS, WARDS;

SELECT COUNT(*)
FROM DEPARTMENTS, WARDS;

SELECT *
FROM DEPARTMENTS JOIN WARDS ON DEPARTMENTS.DEPARTMENT_ID = WARDS.DEPARTMENT_ID;

SELECT WARDS.NAME, DEPARTMENTS.BUILDING, WARDS.FLOOR
FROM DEPARTMENTS JOIN WARDS ON DEPARTMENTS.DEPARTMENT_ID = WARDS.DEPARTMENT_ID
WHERE BUILDING IN (5, 4) AND FLOOR = 1;

INSERT INTO DEPARTMENTS (BUILDING, FINANCING, DEPARTMENT_NAME) VALUES
	(3, 150000, 'Стоматологія');


SELECT *
FROM DEPARTMENTS LEFT JOIN WARDS ON DEPARTMENTS.DEPARTMENT_ID = WARDS.DEPARTMENT_ID;



SELECT *
FROM DISEASES;

--ВИВЕСТИ КІЛЬКІСТЬ ЗАХВЮРУВАНЬ ДЛЯ КОЖНОГО СТУПІНЯ ТЯЖКОСТІ

SELECT COUNT(*), SEVERITY
FROM DISEASES
GROUP BY SEVERITY
ORDER BY SEVERITY DESC;


--ВИВЕСТИ КІЛЬКІСТЬ ЗАХВЮРУВАНЬ ДЛЯ КОЖНОГО СТУПІНЯ ТЯЖКОСТІ  ОКРІМ 3-ГО
SELECT COUNT(*), SEVERITY, string_agg(NAME, ', ') 
FROM DISEASES
WHERE SEVERITY != 3
GROUP BY SEVERITY
ORDER BY SEVERITY DESC;

